SUBROUTINE ALLOCATE_ARRAY()
IMPLICIT NONE

 CALL ALLOCATE_PROBLEM_DEF

 CALL ALLOCATE_FLUID_PROPERTIES

 CALL ALLOCATE_LS_DATA

 CALL ALLOCATE_VOF_DATA

 CALL ALLOCATE_DUMMY_DATA

 CALL ALLOCATE_IBM_DATA

 CALL ALLOCATE_VORTEX_DATA

 
END SUBROUTINE

SUBROUTINE ALLOCATE_PROBLEM_DEF
USE PROBLEM_DEF
IMPLICIT NONE

  ALLOCATE(X(0:NODE_X+1),Y(0:NODE_Y+1),Z(0:NODE_Z+1))
  
END SUBROUTINE

SUBROUTINE ALLOCATE_FLUID_PROPERTIES
USE PROBLEM_DEF
USE FLUID_PROPERTIES
IMPLICIT NONE

ALLOCATE( U(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), V(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), W(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )
ALLOCATE( UH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )

ALLOCATE(U_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), U_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & U1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), US(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & US_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), US_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(V_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), V_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & V1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & VS_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VS_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(W_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), W_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & W1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
       & WS_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WS_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(RHO(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),RHO_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &AMU(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),AMU_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(P(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),P_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &P_OLD2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), P_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &RHS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))


END SUBROUTINE

SUBROUTINE ALLOCATE_LS_DATA
USE PROBLEM_DEF
USE LS_DATA
IMPLICIT NONE
  
  ALLOCATE(PHI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),PHI_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &PHI_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),PHI_V(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &PHI_I(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

  ALLOCATE(NORMAL_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &NORMAL_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &NORMAL_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

  ALLOCATE(CURV(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HEAVY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &DELTA(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),GRAD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
          &SGN(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

END SUBROUTINE

SUBROUTINE ALLOCATE_VOF_DATA
USE PROBLEM_DEF
USE VOF_DATA
IMPLICIT NONE

ALLOCATE( VOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )

ALLOCATE(VOF_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VOF_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VOF_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(VOF_SX(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VOF_SY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VOF_SZ(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(VVOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),  &
        &VOF_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VOF_I(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))


END SUBROUTINE

SUBROUTINE ALLOCATE_DUMMY_DATA
USE PROBLEM_DEF
USE DUMMY_DATA
IMPLICIT NONE

ALLOCATE(S0(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),S1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),S2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(SS0(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),SS1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),SS2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(UP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),UM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &VP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &WP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),WM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(A(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),B(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),C(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(F(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),G(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),H(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(FP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),FM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &HP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
        &GP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),GM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

END SUBROUTINE

SUBROUTINE ALLOCATE_IBM_DATA
USE PROBLEM_DEF
USE IBM_DATA
IMPLICIT NONE

ALLOCATE( SOLID_PHI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), SOLID_VOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )

END SUBROUTINE

SUBROUTINE ALLOCATE_VORTEX_DATA
USE PROBLEM_DEF
USE VORTEX_DATA
IMPLICIT NONE

 ALLOCATE( LAMB_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),LAMB_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),LAMB_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )
 
 ALLOCATE( VOR_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VOR_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VOR_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )
 
 ALLOCATE( LAMB_DIV(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), Q_CRI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), &
         & DELTA_CRI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), LAM2_CRI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )
         
 ALLOCATE( FLEX_PROD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), ENTROPY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HELICITY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )
 
END SUBROUTINE 



