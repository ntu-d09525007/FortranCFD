PROGRAM MAIN
USE PRECISION
USE PROBLEM_DEF
IMPLICIT NONE

 CALL OPENMP_SETTING 
 
OPEN(UNIT=77,FILE='RESULT.DAT')

!DO ITER_CNT = 1, 2
!DO GRID_CNT = 1, 3
 
 CALL SETUP

 DO
 
    ITER = ITER + 1
    TIME = TIME + DT
	
	!CALL VORTEX_VELOCITY
  
    CALL SOLVE_VOF
    CALL SOLVE_LS
	CALL LS_MAINTAIN
    CALL SOLVE_NS
    !CALL SOLVE_IBM

    CALL FIND_MASS   

    !CALL FIND_DAMBREAK_DATA
    CALL PRINT_SCREEN
    CALL PLOT
  
    IF( TIME>TIME_TO_STOP )EXIT
  
    CALL STORE_DATA  
    CALL CPU_REC
  
 END DO

 CALL CPU_END_REC
 !CALL TO_FILE2()
 CALL ERROR_ESTIMATION
 CALL DEALLOCATE_ARRAY()


!ENDDO
!enddo


CONTAINS

INCLUDE "INCLUDED_FILES.F90"

END PROGRAM MAIN
