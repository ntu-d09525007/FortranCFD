SUBROUTINE ALLOCATE_ARRAY()
USE PRECISION
USE PROBLEM_DEF
USE FLUID_PROPERTIES
USE LS_DATA
USE VOF_DATA
USE IBM_DATA
USE DUMMY_DATA

ALLOCATE(X(0:NODE_X+1),Y(0:NODE_Y+1),Z(0:NODE_Z+1))

ALLOCATE(U(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), UH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), U_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), U_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), U1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), US(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), US_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(V(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), V_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), V_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), V1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VS_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(W(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WH(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), W_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), W_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), W1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), WS_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(RHO(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),RHO_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),AMU(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),AMU_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(P(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),P_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),RHS(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(PHI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),PHI_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),PHI_TMP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),PHI_V(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(PHI1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), PHI2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(NORMAL_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),NORMAL_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),NORMAL_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(CURV(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HEAVY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),DELTA(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),GRAD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),SGN(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(VOF_SX(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_SY(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_SZ(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(VVOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), VOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_OLD(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_X(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_Y(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VOF_Z(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(S0(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),S1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),S2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(SS0(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),SS1(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),SS2(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(UP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),UM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),VM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),WP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),WM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(A(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),B(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),C(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE(F(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),G(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),H(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

ALLOCATE( SOLID_PHI(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3), SOLID_VOF(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3) )

ALLOCATE(FP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),FM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),HM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),GP(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3),GM(-2:NODE_X+3,-2:NODE_Y+3,-2:NODE_Z+3))

END SUBROUTINE

SUBROUTINE FREE_ARRAY()
USE PRECISION
USE PROBLEM_DEF
USE FLUID_PROPERTIES
USE LS_DATA
USE VOF_DATA
USE IBM_DATA
USE DUMMY_DATA

DEALLOCATE( X, Y, Z )
DEALLOCATE( U, UH, U_OLD, U_TMP, U1, US, US_OLD )
DEALLOCATE( V, VH, V_OLD, V_TMP, V1, VS, VS_OLD )
DEALLOCATE( W, WH, W_OLD, W_TMP, W1, WS, WS_OLD )
DEALLOCATE( RHO, RHO_OLD, AMU, AMU_OLD )
DEALLOCATE( P, P_OLD, RHS )
DEALLOCATE( PHI, PHI_OLD, PHI_TMP, PHI_V, PHI_I )
DEALLOCATE( NORMAL_X,NORMAL_Y,NORMAL_Z )
DEALLOCATE( CURV, HEAVY, DELTA, GRAD, SGN )
DEALLOCATE( VVOF, VOF, VOF_OLD, VOF_I )
DEALLOCATE( VOF_X, VOF_Y, VOF_Z )
DEALLOCATE( VOF_SX,VOF_SY,VOF_SZ )
DEALLOCATE( SOLID_PHI, SOLID_VOF )
DEALLOCATE( S0,S1,S2,SS0,SS1,SS2 )
DEALLOCATE( UP,UM,VP,VM,WP,WM )
DEALLOCATE( A,B,C,F,G,H )
DEALLOCATE( FP,FM,GP,GM,HP,HM )

END SUBROUTINE